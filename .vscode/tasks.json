{
    "version": "2.0.0",
    "tasks": [
        {
            // Run if:
            // - Dockerfile is changed
            // - package.json is changed
            // - before pushing the image
            // No need to run if:
            // - only src is changed (docker-run maps src to container)
            "label": "docker-build",
            "type": "shell",
            "command": "docker build -t blaczk0/homepage:1.0 .",
            "problemMatcher": []
        },
        {
            // Creates a container from the image generated by docker-build
            // Maps local src folder to container's src folder
            // Runs the app with nodemon live reload (allowed by the mapping in the prev mode)
            // Maps local port 8080 to container's port 80
            "label": "docker-run",
            "type": "shell",
            "command": "docker run -p 80:80 -p 443:443 --name homepage -v ${workspaceFolder}\\src:/app/src blaczk0/homepage:1.0 npm run watch",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "docker-remove",
            "type": "shell",
            "command": "docker rm -f homepage",
            "problemMatcher": []
        }
    ]
}